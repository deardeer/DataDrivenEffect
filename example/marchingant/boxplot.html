<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <style>
            svg{position:absolute;left:0px;top:0px;z-index: -1;}
            canvas{position:absolute;left:0px;top:0px;}
        </style>
    </head>
    <body>

        <script src = "{{static_url('./lib/EventEmitter.js')}} "></script>
        <script src = "{{static_url('./lib/jquery.js')}}"></script>
        <script src = "{{static_url('./lib/jscolor.min.js')}} "></script>
        <script src = "{{static_url('./lib/paper-full.js')}} "></script>
        <script src = "{{static_url('./lib/d3.js')}} "></script>
        <script src = "{{static_url('./src/js/boxplot.js')}}"></script>
        <script src = "{{static_url('./src/js/marchingants.js')}}"></script>

        <canvas id = "aecanvas" width="800" height="800" display=" inline"></canvas>

        <div>
            <svg style="position: absolute; top: 0; left: 0" id="drawsvg"></svg>
        </div>

        <script>
            boxplot = function(){
                var theoneflag
                var thelastflag = false
                var imgWidth, imgHeight;
                var largeScreenSizeSetting = {width: 1020, height: 720}
                var smallScreenSizeSetting = {width: 800, height: 600}

                imgWidth = smallScreenSizeSetting.width
                imgHeight = smallScreenSizeSetting.height

                var _svg = d3.selectAll('svg')
                .attr('width', imgWidth)
                .attr('height', imgHeight);

                console.log(' canvas width ', imgWidth, imgHeight);

                var _canvas = d3.select('#aecanvas')
                                .attr('width', imgWidth)
                                .attr('height', imgHeight);

                var canvas = document.getElementById('aecanvas');
                // Create an empty project and a view for the canvas:
                paper.setup(canvas);
                paper.install(window);
                paper.view.draw();

                drawBoxplot();
                var result = autoBoxplotMA();
                var antModal = result['antmodal']
                var allGroupMap = result['groups']
                
                var liGroupId = Object.keys(allGroupMap)

                for(var i = 0; i < liGroupId.length; i ++){
                    if(i == 0){
                        theoneflag = true;
                    }
                    else{
                        theoneflag = false;
                    }

                    if(i == liGroupId.length-1){
                        thelastflag = true;
                    }

                    var groupId = liGroupId[i]
                    var tempGroup = allGroupMap[groupId]
                    console.log("tempGroup",tempGroup)
                    var aeInfo = tempGroup["mainfo"]
                    // console.log("aninfo", aeInfo)
                    var malist = tempGroup["malist"]
                    interval = aeInfo["antinterval"]
                    gap = aeInfo["antgap"]
                    color = aeInfo["antcolor"]

                    ant = malist[0]["path"]["dots"]
                    path = malist[0]["boundary"]["dots"]
                    // functionHub.addMAbyGroupwithExampleAnt(tempGroup,antModal)

                    marchingAnt(path, ant, interval, gap, groupId, color, antModal, theoneflag, thelastflag)
                }
            
            }
        </script>

        <script>
            // this.marchingAnt4 = function(Path, Ant, Interval, Gap, GroupId, Color, AntModal, IstheOne, IsLast){

            //     if(IstheOne == true){
            //         this._functionHub = FunctionHub();
            //     }
                

            //     var malist = []
            //     var aeInfo = {}
            //     var mapGroupIdMaList = {}

            //     if(AntModal != undefined){
            //         var boundry = {"dots": Path}
            //         var path = {"dots": Ant}
            //         malist.push({"boundry": boundry, "path": path})
            //     }
            //     else{
            //         var malistpath = {"geotype":"area", "dots":Path}
            //         var malistant = {"geotype":"area", "dots":Ant}
            //         malist.push({"path": malistpath, "ant": malistant})
            //     }
                 
                
            //     aeInfo["ae"] = "MA"
            //     aeInfo["antcolor"] = Color
            //     aeInfo["antgap"] = Gap
            //     aeInfo["antinterval"] = Interval
            //     aeInfo["groupid"] = GroupId ;
            //     aeInfo["antshape"] = "self-defined"

            //     mapGroupIdMaList["malist"] = malist
            //     mapGroupIdMaList["mainfo"] = aeInfo

            //     // if(AntModal != undefined){
            //     //     this._functionHub.addMAbyGroupwithExampleAnt(mapGroupIdMaList,AntModal)
            //     // }
            //     // else{
            //     //     this._functionHub.addMAbyGroupInfo(mapGroupIdMaList[groupId], drawPath, canvasid)
            //     // }
            //     this._functionHub.addMAbyGroupwithExampleAnt(mapGroupIdMaList,AntModal)
                
            //     if(IsLast == true){
            //         this._functionHub._type = 'animate'
            //         this._functionHub.initFunc()
            //     }  

            // }

            boxplot()
        </script>
    </body>
</html>